# 小红书风格社区 App 需求规格说明书（MVP 版）

> **文档版本**：v1.0  
> **最后更新**：2026年1月7日  
> **作者**：Product & Backend Team  
> **目标平台**：iOS / Android / Web（响应式）  
> **后端技术栈建议**：Spring Boot + MySQL + Redis + MinIO/OSS + Kafka

---

## 一、引言

### 1.1 背景
打造一个以“生活方式分享”为核心的 UGC（用户生成内容）社区平台，用户可发布图文/短视频笔记，关注他人，点赞、收藏、评论，形成兴趣社交圈。

### 1.2 目标
- 上线 3 个月内获取 1 万 DAU
- 用户平均停留时长 ≥ 8 分钟
- 笔记发布转化率 ≥ 5%

### 1.3 范围（MVP）
✅ 包含：
- 用户注册/登录
- 发布图文笔记
- 流式浏览推荐笔记（首页）
- 点赞、收藏、评论
- 个人主页 & 关注/粉丝
- 搜索（按关键词）

❌ 不包含（V2+）：
- 短视频上传（仅图片+文字）
- 私信聊天
- 电商带货
- 直播
- 多语言支持

---

## 二、用户角色

| 角色 | 描述 |
|------|------|
| 游客 | 可浏览公开笔记、搜索，不可互动 |
| 普通用户 | 已注册用户，可发布、点赞、评论、关注等 |
| 管理员 | 后台审核内容、封禁账号（本版本仅基础管理） |

---

## 三、功能需求

### 3.1 用户系统

#### 3.1.1 手机号注册/登录
- 支持中国大陆手机号 + 短信验证码
- 密码可选（首次登录后可设）
- 自动创建默认头像和昵称（如“用户123456”）

> **后端接口**：`POST /api/v1/auth/register`  
> **安全要求**：验证码 5 分钟有效，IP 限流（10次/小时）

#### 3.1.2 个人资料
- 昵称（可修改，唯一性不强制）
- 头像（上传图片，≤2MB）
- 简介（≤100 字）

---

### 3.2 笔记（Note）系统

#### 3.2.1 发布笔记
- 内容：标题（≤30字）、正文（≤1000字）、图片（1～9张，≤5MB/张）
- 标签（Hashtag）：自动提取 #xxx，最多 5 个
- 默认公开，暂不支持私密

> **后端接口**：`POST /api/v1/notes`  
> **存储**：图片存对象存储（MinIO/OSS），URL 存 DB  
> **异步处理**：图片压缩、敏感词检测（调用审核服务）

#### 3.2.2 浏览笔记（首页 Feed 流）
- 按时间倒序展示**关注用户**的笔记（初期无推荐算法）
- 分页加载：每页 10 条，支持下拉刷新、上滑加载

> **后端接口**：`GET /api/v1/notes/feed?page=1&size=10`  
> **性能要求**：P99 < 800ms（1万用户规模）

#### 3.2.3 笔记详情
- 展示笔记内容、作者信息、发布时间
- 显示互动数：点赞数、收藏数、评论数

---

### 3.3 互动功能

| 功能 | 规则 |
|------|------|
| **点赞** | 单用户对同一笔记只能点一次，可取消 |
| **收藏** | 收藏后可在“我的收藏”查看 |
| **评论** | 支持文字评论（≤200字），不支持回复嵌套（Flat 结构） |
| **关注** | 关注后，对方笔记出现在 Feed 流；可取消关注 |

> **后端接口示例**：
> - `POST /api/v1/notes/{noteId}/like`
> - `POST /api/v1/notes/{noteId}/collect`
> - `POST /api/v1/notes/{noteId}/comments`

> **数据一致性**：点赞/收藏数需实时更新（Redis 缓存 + 定时同步 DB）

---

### 3.4 个人主页
- 展示用户基本信息
- Tab 切换：发布的笔记 / 收藏的笔记
- 显示关注数、粉丝数

> **后端接口**：`GET /api/v1/users/{userId}`

---

### 3.5 搜索
- 按笔记标题/正文关键词模糊搜索
- 返回笔记列表（含封面图、标题、作者）
- 不支持标签/用户搜索（MVP）

> **后端接口**：`GET /api/v1/search?keyword=旅行`  
> **实现建议**：MySQL 全文索引 or Elasticsearch（若资源允许）

---

## 四、非功能需求

| 类型 | 要求 |
|------|------|
| **性能** | - 首页加载 ≤1s<br>- 发布笔记 ≤2s（含图片上传） |
| **安全性** | - 敏感词过滤（政治、色情、广告）<br>- 防刷：点赞/评论 10次/分钟/IP<br>- JWT Token 认证，有效期 7 天 |
| **可靠性** | - 服务可用性 ≥ 99.5%<br>- 图片上传失败需重试机制 |
| **可观测性** | - 关键操作埋点（发布、点赞、搜索）<br>- ELK 收集日志，Prometheus 监控 JVM/DB |
| **扩展性** | - 接口设计预留字段（如 `ext_info`）<br>- 笔记表支持未来加视频字段 |

---

## 五、数据模型（核心表）

### user 表
| 字段 | 类型 | 说明 |
|------|------|------|
| id | BIGINT PK | 用户ID |
| phone | VARCHAR(11) UNIQUE | 手机号 |
| nickname | VARCHAR(50) | 昵称 |
| avatar_url | VARCHAR(255) | 头像URL |
| created_at | DATETIME | 注册时间 |

### note 表
| 字段 | 类型 | 说明 |
|------|------|------|
| id | BIGINT PK | 笔记ID |
| user_id | BIGINT | 作者ID |
| title | VARCHAR(100) | 标题 |
| content | TEXT | 正文 |
| images | JSON | 图片URL数组（如 ["url1", "url2"]） |
| like_count | INT DEFAULT 0 | 点赞数 |
| collect_count | INT DEFAULT 0 | 收藏数 |
| comment_count | INT DEFAULT 0 | 评论数 |
| created_at | DATETIME | 发布时间 |

### relation 表（关注关系）
| 字段 | 类型 |
|------|------|
| follower_id | BIGINT | 粉丝ID |
| followee_id | BIGINT | 被关注者ID |
| created_at | DATETIME |

> ✅ 建议为 `note(user_id, created_at)`、`relation(follower_id)` 加索引

---

## 六、验收标准（部分示例）

| 场景 | Given | When | Then |
|------|-------|------|------|
| 成功发布笔记 | 用户已登录 | 提交合规标题+图片 | 返回 201，笔记出现在个人主页和粉丝 Feed |
| 重复点赞 | 用户已点赞某笔记 | 再次点击点赞 | 点赞数不变，接口返回成功（幂等） |
| 搜索关键词 | 笔记A含“咖啡” | 搜索“咖啡” | 笔记A出现在结果列表 |
| 未登录用户点赞 | 用户未登录 | 点击点赞 | 返回 401，跳转登录页 |

---

## 七、后续迭代方向（V2+）
- 短视频支持（HLS/MP4）
- 推荐算法（基于兴趣标签）
- 评论回复（树形结构）
- 举报与内容审核后台
- 消息通知（点赞/评论提醒）

---

## 附录：错误码规范（后端统一）

| 错误码 | 含义 |
|--------|------|
| 1001 | 用户未登录 |
| 1002 | 手机号格式错误 |
| 1003 | 验证码错误或过期 |
| 2001 | 笔记不存在 |
| 2002 | 无权操作（如编辑他人笔记） |
| 3001 | 敏感词 detected |
| 4000 | 参数校验失败 |